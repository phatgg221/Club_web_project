(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[22],{3015:function(e,t,a){(window.__NEXT_P=window.__NEXT_P||[]).push(["/admin/Card/form",function(){return a(1865)}])},1865:function(e,t,a){"use strict";a.r(t);var o=a(5893),n=a(7294),i=a(1163),r=a(7148),l=a.n(r),s=a(1993),d=a.n(s),c=a(4436);let m=()=>{let{isAdmin:e}=(0,c.a)(),t=(0,i.useRouter)(),{id:a}=t.query;console.log("id asdasdasd"+a);let[r,s]=(0,n.useState)({organizer:"",logoURL:"/RMIT-logo.png",competitionName:"",location:"",linkToWeb:"",imageURL:""}),[m,_]=(0,n.useState)(!1),[p,u]=(0,n.useState)(""),[b,h]=(0,n.useState)("");(0,n.useEffect)(()=>{a&&(async()=>{try{_(!0);let e=await fetch("/api/card_api?id=".concat(a)),t=await e.json();t&&!1===t.error&&200===t.statusCode&&t.data&&t.data.cardData&&t.data.cardData.data?s(t.data.cardData.data):console.error("Data structure is not as expected:",t)}catch(e){console.error("Error fetching data:",e)}})()},[a]);let f=e=>{let{name:t,value:a}=e.target;"linkToWeb"===t&&(/^(http|https):\/\/.+/.test(a)?(h(""),u("")):(h("Invalid format. Cannot submit."),u("Invalid link format. Requires to start with: http:// or https://"))),s({...r,[e.target.name]:e.target.value})},g=async e=>{if(e.preventDefault(),b){alert("Invalid form. Cannot submit.");return}try{let e={...r},t=document.getElementById("Image").files[0];if(t){let a=new FormData;a.append("file",t),a.append("upload_preset","lzz18aot");let o=await fetch("https://api.cloudinary.com/v1_1/dhjapmqga/image/upload",{method:"POST",body:a});if(!o.ok)throw Error("Failed to upload image.");let n=await o.json();e.imageURL=n.secure_url}if(!(await fetch("/api/card_api?id=".concat(a),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})).ok)throw Error("Network response was not ok");window.location.href="/admin/Card/view"}catch(e){console.error("Error:",e)}},w=async e=>{e.preventDefault();try{let e={...r},t=new FormData;t.append("file",document.getElementById("Image").files[0]),t.append("upload_preset","lzz18aot");let a=await fetch("https://api.cloudinary.com/v1_1/dhjapmqga/image/upload",{method:"POST",body:t});if(!a.ok)throw Error("Failed to upload image.");let o=await a.json();if(e.imageURL=o.secure_url,!(await fetch("/api/card_api",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(e)})).ok)throw Error("Failed to submit card data.");window.location.href="/admin/Card/view"}catch(e){console.error("Error:",e),h("Failed to submit. Please try again.")}};return(0,n.useEffect)(()=>{e||t.push("/login")},[e,t]),(0,o.jsx)("div",{className:l().formContainer,children:(0,o.jsxs)("form",{className:l().form,onSubmit:w,children:[(0,o.jsxs)("div",{className:l().inputGroup,children:[(0,o.jsx)("label",{children:"Competition Name:"}),(0,o.jsx)("input",{required:!0,type:"text",name:"competitionName",placeholder:m?r.competitionName:"",value:r.competitionName,onChange:f})]}),(0,o.jsxs)("div",{className:l().Row,children:[(0,o.jsxs)("div",{className:"".concat(l().inputGroup," ").concat(l().organizerInput),children:[(0,o.jsx)("label",{children:"Organizer:"}),(0,o.jsx)("input",{required:!0,type:"text",name:"organizer",placeholder:m?r.organizer:"",value:r.organizer,onChange:f})]}),(0,o.jsxs)("div",{className:l().inputGroup,children:[(0,o.jsx)("label",{children:"Location:"}),(0,o.jsx)("input",{require:!0,type:"text",name:"location",placeholder:m?r.location:"",value:r.location,onChange:f})]})]}),(0,o.jsxs)("div",{className:l().inputGroup,children:[(0,o.jsx)("label",{children:"Link to Web:"}),(0,o.jsx)("input",{type:"text",name:"linkToWeb",placeholder:m?r.linkToWeb:"",value:r.linkToWeb,required:!0,onChange:f}),p&&(0,o.jsx)("p",{className:"error",children:p})]}),(0,o.jsxs)("div",{className:l().inputGroup,children:[(0,o.jsx)("label",{children:"Image:"}),(0,o.jsx)("input",{id:"Image",type:"file",name:"imageURL",accept:".jpeg, .png, .jpg",require:!0})]}),(0,o.jsxs)("div",{className:d().btnBottomDiv,children:[(0,o.jsx)("button",{className:"".concat(d().btn," ").concat(d().btnBottom," ").concat(d().btnForm),type:"submit",onClick:m?g:w,children:m?"Update":"Create"}),(0,o.jsx)("button",{className:"".concat(d().btn," ").concat(d().btnBottom," ").concat(d().btnForm," "),type:"button",onClick:()=>{window.location.href="/admin/Card/view"},children:"Return"})]})]})})};m.hideLayout=!0,t.default=m},7148:function(e){e.exports={formContainer:"Admin_Form_formContainer__woS1p",formContainerTips:"Admin_Form_formContainerTips__EqLt9",userResetPasswordContainer:"Admin_Form_userResetPasswordContainer__8cHa0",formContainerAdminChangePassword:"Admin_Form_formContainerAdminChangePassword__2ZidI",form:"Admin_Form_form__TPPNs",formTips:"Admin_Form_formTips__LsRp0",inputGroup:"Admin_Form_inputGroup__tdFHl",inputGroupTips:"Admin_Form_inputGroupTips__zzKew",Row:"Admin_Form_Row__LVOvY",row:"Admin_Form_row__MxQDQ",organizerInput:"Admin_Form_organizerInput__0pcKt",hideLable:"Admin_Form_hideLable__CrPVN",btnTip:"Admin_Form_btnTip__7GRqP",contentInput:"Admin_Form_contentInput__L_npg",centered:"Admin_Form_centered__GuOUu",notificationMessage:"Admin_Form_notificationMessage__HpZle"}},1993:function(e){e.exports={divTable:"table_divTable__nZy3u",mainTable:"table_mainTable__2ozUS",tableHeading:"table_tableHeading__G1BNY",tableRow:"table_tableRow__OefgE",imageTable:"table_imageTable__8IOsJ",btnTableDiv:"table_btnTableDiv__TZLkB",btn:"table_btn__1oU_a",btnTable:"table_btnTable__M5Q8P",btnBottomDiv:"table_btnBottomDiv__9kcEX",btnBottom:"table_btnBottom__tziMg",btnForm:"table_btnForm__3wNV1"}},1163:function(e,t,a){e.exports=a(2937)}},function(e){e.O(0,[774,888,179],function(){return e(e.s=3015)}),_N_E=e.O()}]);